<div class="p-5 w-[90%] h-full mx-auto flex flex-col space-y-10">
  <div class="flex flex-row justify-between items-start border-b-2 border-gray-200 pb-4">
    <h1 class="text-5xl font-semibold text-stone-950 dark:text-neutral-100">{{ instrumental.instName }}</h1>
  </div>

  <div class="flex flex-col w-full">
    <label class="text-stone-950 font-semibold mb-3 text-2xl dark:text-neutral-100">Portada:</label>
    <div *ngIf="instrumental?.coverUrl" class="relative">
      <img [src]="coverFullUrl" alt="Portada" class="w-64 h-64 object-cover rounded-lg shadow-md">
    </div>
  </div>

  <div class="flex flex-wrap items-center justify-between gap-4 p-4 bg-zinc-100 rounded-lg dark:bg-stone-900">
    <div class="flex flex-col md:flex-row md:items-center gap-6">
      <div class="flex items-center gap-3">
        <span class="text-stone-950 font-semibold text-xl dark:text-neutral-100">BPM:</span>
        <span class="text-lg text-zinc-700 dark:text-gray-300">{{ instrumental.bpm }}</span>
      </div>

      <div class="flex items-center gap-3">
        <span class="text-stone-950 font-semibold text-xl dark:text-neutral-100">Visibilidad:</span>
        <span class="text-lg text-zinc-700 dark:text-gray-300">{{ instrumental.public ? 'PÃºblico' : 'Privado' }}</span>
      </div>
    </div>

    <button type="button" (click)="togglePlay()"
            class="px-8 py-3 border border-emerald-500 text-emerald-500 py-1 rounded hover:bg-emerald-500 hover:text-white flex items-center gap-2">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="h-6 w-6 fill-current">
        <path *ngIf="!isPlaying" d="M8 5v14l11-7z"/>
        <path *ngIf="isPlaying" d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/>
      </svg>
      {{ isPlaying ? 'Detener' : 'Reproducir' }}
    </button>
  </div>

  <div class="w-full bg-stone-900 p-6 rounded-lg space-y-6 shadow-lg">
    <div *ngFor="let row of rows; let rowIndex = index" class="row mb-8 last:mb-0">
      <div class="flex flex-col sm:flex-row sm:items-center mb-4 gap-4">
        <div class="flex items-center gap-3 min-w-[200px]">
            <div class="rounded-full flex-shrink-0 overflow-hidden flex items-center justify-center"
              [style.backgroundColor]="row.category.color"
              [title]="row.category.name"
              style="width: 50px; height: 50px;">
              <img [src]="`${environment.apiUrl}/uploads/` + row.category.iconUrl"
                  alt="Icono"
                  class="w-20 h-20 object-contain">
            </div>
            <span class="text-white font-semibold text-lg">{{ row.category.name }}</span>
          </div>

        <div class="flex-grow p-2 rounded bg-zinc-800 text-white border border-zinc-700">
          {{ row.selectedSound?.name || 'Sin sonido' }}
        </div>
      </div>

      <div class="grid grid-cols-12 gap-2 mt-2">
        <div *ngFor="let step of row.steps; let colIndex = index"
             class="h-14 rounded transition-all relative"
             [style.backgroundColor]="step.active ? row.category.color : ''"
             [class.bg-zinc-800]="!step.active"
             [class.ring-2]="colIndex === currentStep && isPlaying"
             [class.ring-yellow-400]="colIndex === currentStep && isPlaying">
        </div>
      </div>
    </div>
  </div>
</div>
